# =============================================================================
# File: mypy.ini
# Purpose:
#   Static type-checker settings for Python 3.12 codebase with Pydantic v2.
#   Strict defaults, targeted ignores for thirdâ€‘party libs, and safe excludes.
# =============================================================================

[mypy]
python_version = 3.12
warn_unused_configs = True
warn_redundant_casts = True
warn_unused_ignores = True
warn_return_any = True
warn_unreachable = True
no_implicit_optional = True
strict_optional = True
strict_equality = True
pretty = True
show_error_codes = True
check_untyped_defs = True
disallow_any_generics = True
disallow_incomplete_defs = True
disallow_untyped_defs = True
namespace_packages = True

# Exclude certain generated or fixture directories from type checking.
# NOTE: Keep as a single-line regex to avoid INI parsing issues.
exclude = ^(migrations/|tests/fixtures/|scripts/wizards/|reports/|backups/|private_documentation/|docs/|sql/|logs/)

# Optional: Enable Pydantic plugin (supports v2). Remove if undesired.
plugins = sqlalchemy.ext.mypy.plugin, pydantic.mypy

[mypy-sqlalchemy.*]
ignore_missing_imports = True

[mypy-alembic.*]
ignore_missing_imports = True

[mypy-sqlfluff.*]
ignore_missing_imports = True

[mypy-dotenv.*]
ignore_missing_imports = True

[mypy-typer]
ignore_missing_imports = True

[mypy-typer.testing]
ignore_missing_imports = True

[mypy-psycopg.*]
ignore_missing_imports = True

[mypy-psycopg_pool.*]
ignore_missing_imports = True

[mypy-pytest.*]
ignore_missing_imports = True

[mypy-scripts.*]
disallow_untyped_defs = False
check_untyped_defs = False
disable_error_code = misc,var-annotated,unreachable

[mypy-docs.*]
disallow_untyped_defs = False
check_untyped_defs = False
disable_error_code = misc,var-annotated,unreachable

[mypy-private_documentation.*]
disallow_untyped_defs = False
check_untyped_defs = False
disable_error_code = misc,var-annotated,unreachable

# Our test tree may use pytest-only names; keep it slightly lenient.
[mypy-tests.*]
disallow_untyped_defs = False
check_untyped_defs = False
disable_error_code = attr-defined,no-any-return,return-value,arg-type,type-arg,unused-ignore,misc,var-annotated,unreachable

[mypy-tests.integration.test_seeding_idempotent]
ignore_errors = True
