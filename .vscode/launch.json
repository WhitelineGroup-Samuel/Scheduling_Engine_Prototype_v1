// =============================================================================
// File: .vscode/launch.json
// Purpose:
//   Debug launchers for run.py and CLI commands with consistent env selection.
//
// Conventions:
//   - Dev launchers set:  APP_ENV=dev  and ENV_FILE=.env
//   - Test launcher sets: APP_ENV=test and ENV_FILE=.env.test
//   - We use `env` (not envFile) so our custom loader reads ENV_FILE explicitly.
// =============================================================================
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Run: run.py (dev, banner + db check)",
      "type": "debugpy",
      "request": "launch",
      "program": "${workspaceFolder}/run.py",
      "args": [],
      "console": "integratedTerminal",
      "justMyCode": true,
      "env": {
        "APP_ENV": "dev",
        "ENV_FILE": "${workspaceFolder}/.env"
      }
    },
    {
      "name": "Run: run.py (dev, no banner, skip db)",
      "type": "debugpy",
      "request": "launch",
      "program": "${workspaceFolder}/run.py",
      "args": [
        "--no-banner",
        "--skip-db-check"
      ],
      "console": "integratedTerminal",
      "justMyCode": true,
      "env": {
        "APP_ENV": "dev",
        "ENV_FILE": "${workspaceFolder}/.env"
      }
    },
    {
      "name": "CLI: check-env (dev)",
      "type": "debugpy",
      "request": "launch",
      "program": "${workspaceFolder}/manage.py",
      "args": [
        "check-env",
        "-v"
      ],
      "console": "integratedTerminal",
      "justMyCode": true,
      "env": {
        "APP_ENV": "dev",
        "ENV_FILE": "${workspaceFolder}/.env"
      }
    },
    {
      "name": "CLI: init-db (upgrade head)",
      "type": "debugpy",
      "request": "launch",
      "program": "${workspaceFolder}/manage.py",
      "args": [
        "init-db"
      ],
      "console": "integratedTerminal",
      "justMyCode": true,
      "env": {
        "APP_ENV": "dev",
        "ENV_FILE": "${workspaceFolder}/.env"
      }
    },
    {
      "name": "CLI: seed-data (dry-run)",
      "type": "debugpy",
      "request": "launch",
      "program": "${workspaceFolder}/manage.py",
      "args": [
        "seed-data"
      ],
      "console": "integratedTerminal",
      "justMyCode": true,
      "env": {
        "APP_ENV": "dev",
        "ENV_FILE": "${workspaceFolder}/.env"
      }
    },
    {
      "name": "CLI: seed-data (apply)",
      "type": "debugpy",
      "request": "launch",
      "program": "${workspaceFolder}/manage.py",
      "args": [
        "seed-data",
        "--apply"
      ],
      "console": "integratedTerminal",
      "justMyCode": true,
      "env": {
        "APP_ENV": "dev",
        "ENV_FILE": "${workspaceFolder}/.env"
      }
    },
    {
      "name": "Tests: pytest (uses .env.test automatically)",
      "type": "debugpy",
      "request": "launch",
      "program": "${workspaceFolder}/.venv/bin/pytest",
      "args": [
        "-q",
        "-ra"
      ],
      "console": "integratedTerminal",
      "justMyCode": true,
      "env": {
        "APP_ENV": "test",
        "ENV_FILE": "${workspaceFolder}/.env.test",
        "PYTEST_ADDOPTS": "--maxfail=1"
      }
    },
    {
      "name": "Attach: Python process",
      "type": "debugpy",
      "request": "attach",
      "connect": {
        "host": "localhost",
        "port": 5678
      },
      "justMyCode": true
    }
  ]
}
